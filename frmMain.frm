VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form frmMain 
   BackColor       =   &H00C0C0C0&
   BorderStyle     =   0  'None
   Caption         =   "Form1"
   ClientHeight    =   8175
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   11850
   Icon            =   "frmMain.frx":0000
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   Picture         =   "frmMain.frx":08CA
   ScaleHeight     =   545
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   790
   ShowInTaskbar   =   0   'False
   StartUpPosition =   2  'CenterScreen
   Begin VB.PictureBox Graveyard 
      AutoSize        =   -1  'True
      BackColor       =   &H00004080&
      BorderStyle     =   0  'None
      FillColor       =   &H00AF855A&
      Height          =   3300
      Index           =   1
      Left            =   90
      Picture         =   "frmMain.frx":75A8
      ScaleHeight     =   220
      ScaleMode       =   3  'Pixel
      ScaleWidth      =   503
      TabIndex        =   14
      Top             =   9000
      Width           =   7545
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   79
         Left            =   6420
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   78
         Left            =   6090
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   77
         Left            =   5760
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   76
         Left            =   5430
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   75
         Left            =   5100
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   74
         Left            =   4770
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   73
         Left            =   4440
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   72
         Left            =   4110
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   71
         Left            =   3780
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   70
         Left            =   3450
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   69
         Left            =   3120
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   68
         Left            =   2790
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   67
         Left            =   2460
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   66
         Left            =   2130
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   65
         Left            =   1800
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   64
         Left            =   1470
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   63
         Left            =   1140
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   62
         Left            =   810
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   61
         Left            =   480
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   60
         Left            =   150
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   59
         Left            =   6420
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   58
         Left            =   6090
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   57
         Left            =   5760
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   56
         Left            =   5430
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   55
         Left            =   5100
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   54
         Left            =   4770
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   53
         Left            =   4440
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   52
         Left            =   4110
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   51
         Left            =   3780
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   50
         Left            =   3450
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   49
         Left            =   3120
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   48
         Left            =   2790
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   47
         Left            =   2460
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   46
         Left            =   2130
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   45
         Left            =   1800
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   44
         Left            =   1470
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   43
         Left            =   1140
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   42
         Left            =   810
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   41
         Left            =   480
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   40
         Left            =   150
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
   End
   Begin MSComctlLib.ImageList imlIcons 
      Left            =   720
      Top             =   315
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   15
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":919D
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":9281
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":9355
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":942E
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":94FC
            Key             =   ""
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":95DD
            Key             =   ""
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":96BF
            Key             =   ""
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":979E
            Key             =   ""
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":9879
            Key             =   ""
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":9968
            Key             =   ""
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":9A77
            Key             =   ""
         EndProperty
         BeginProperty ListImage12 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":9B87
            Key             =   ""
         EndProperty
         BeginProperty ListImage13 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":9C8E
            Key             =   ""
         EndProperty
         BeginProperty ListImage14 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":9DA5
            Key             =   ""
         EndProperty
         BeginProperty ListImage15 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":9EAA
            Key             =   ""
         EndProperty
      EndProperty
   End
   Begin VB.Timer tmrComp 
      Enabled         =   0   'False
      Interval        =   1000
      Left            =   1440
      Top             =   315
   End
   Begin VB.PictureBox Graveyard 
      AutoSize        =   -1  'True
      BackColor       =   &H00004080&
      BorderStyle     =   0  'None
      FillColor       =   &H00AF855A&
      Height          =   3300
      Index           =   0
      Left            =   90
      Picture         =   "frmMain.frx":9FB8
      ScaleHeight     =   220
      ScaleMode       =   3  'Pixel
      ScaleWidth      =   503
      TabIndex        =   8
      Top             =   9000
      Width           =   7545
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   39
         Left            =   150
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   38
         Left            =   480
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   37
         Left            =   810
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   36
         Left            =   1140
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   35
         Left            =   1470
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   34
         Left            =   1800
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   33
         Left            =   2130
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   32
         Left            =   2460
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   31
         Left            =   2790
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   30
         Left            =   3120
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   29
         Left            =   3450
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   28
         Left            =   3780
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   27
         Left            =   4110
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   26
         Left            =   4440
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   25
         Left            =   4770
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   24
         Left            =   5100
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   23
         Left            =   5430
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   22
         Left            =   5760
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   21
         Left            =   6090
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   20
         Left            =   6420
         Top             =   1695
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   19
         Left            =   150
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   18
         Left            =   480
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   17
         Left            =   810
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   16
         Left            =   1140
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   15
         Left            =   1470
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   14
         Left            =   1800
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   13
         Left            =   2130
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   12
         Left            =   2460
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   11
         Left            =   2790
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   10
         Left            =   3120
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   9
         Left            =   3450
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   8
         Left            =   3780
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   7
         Left            =   4110
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   6
         Left            =   4440
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   5
         Left            =   4770
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   4
         Left            =   5100
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   3
         Left            =   5430
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   2
         Left            =   5760
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   1
         Left            =   6090
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
      Begin VB.Image imgGY 
         Appearance      =   0  'Flat
         Height          =   1485
         Index           =   0
         Left            =   6420
         Top             =   120
         Visible         =   0   'False
         Width           =   990
      End
   End
   Begin MSComctlLib.ImageList imlFrames 
      Left            =   90
      Top             =   315
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   190
      ImageHeight     =   285
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   8
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":BBAD
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":D749
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":F27F
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":10E8D
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":11CC9
            Key             =   ""
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":12A81
            Key             =   ""
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":1540C
            Key             =   ""
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmMain.frx":19D26
            Key             =   ""
         EndProperty
      EndProperty
   End
   Begin VB.Label lblOk 
      Alignment       =   2  'Center
      BackStyle       =   0  'Transparent
      Caption         =   "[ Continue ]"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00004080&
      Height          =   255
      Left            =   2925
      TabIndex        =   2
      Top             =   4125
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.Label lblData 
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Serif"
         Size            =   6.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   210
      Index           =   5
      Left            =   7905
      TabIndex        =   13
      Top             =   5010
      Width           =   1350
   End
   Begin VB.Image imgField 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   1
      Left            =   90
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgField 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   0
      Left            =   90
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Label lblMenu 
      Alignment       =   2  'Center
      BackStyle       =   0  'Transparent
      Caption         =   "Exit"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   11.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00004080&
      Height          =   315
      Index           =   2
      Left            =   10725
      TabIndex        =   12
      Top             =   4320
      Width           =   1080
   End
   Begin VB.Label lblMenu 
      Alignment       =   2  'Center
      BackStyle       =   0  'Transparent
      Caption         =   "New Game"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   11.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00004080&
      Height          =   315
      Index           =   0
      Left            =   10725
      TabIndex        =   11
      Top             =   3600
      Width           =   1080
   End
   Begin VB.Label lblData 
      Alignment       =   1  'Right Justify
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Serif"
         Size            =   6.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   210
      Index           =   4
      Left            =   9600
      TabIndex        =   10
      Top             =   6000
      Width           =   840
   End
   Begin VB.Image imgStar 
      Height          =   210
      Index           =   9
      Left            =   8085
      Top             =   2370
      Visible         =   0   'False
      Width           =   210
   End
   Begin VB.Image imgStar 
      Height          =   210
      Index           =   8
      Left            =   8310
      Top             =   2370
      Visible         =   0   'False
      Width           =   210
   End
   Begin VB.Image imgStar 
      Height          =   210
      Index           =   7
      Left            =   8535
      Top             =   2370
      Visible         =   0   'False
      Width           =   210
   End
   Begin VB.Image imgStar 
      Height          =   210
      Index           =   6
      Left            =   8760
      Top             =   2370
      Visible         =   0   'False
      Width           =   210
   End
   Begin VB.Image imgStar 
      Height          =   210
      Index           =   5
      Left            =   8985
      Top             =   2370
      Visible         =   0   'False
      Width           =   210
   End
   Begin VB.Image imgStar 
      Height          =   210
      Index           =   4
      Left            =   9210
      Top             =   2370
      Visible         =   0   'False
      Width           =   210
   End
   Begin VB.Image imgStar 
      Height          =   210
      Index           =   3
      Left            =   9435
      Top             =   2370
      Visible         =   0   'False
      Width           =   210
   End
   Begin VB.Image imgStar 
      Height          =   210
      Index           =   2
      Left            =   9660
      Top             =   2370
      Visible         =   0   'False
      Width           =   210
   End
   Begin VB.Image imgStar 
      Height          =   210
      Index           =   1
      Left            =   9885
      Top             =   2370
      Visible         =   0   'False
      Width           =   210
   End
   Begin VB.Image imgStar 
      Height          =   210
      Index           =   0
      Left            =   10110
      Top             =   2370
      Visible         =   0   'False
      Width           =   210
   End
   Begin VB.Image imgIcon 
      Height          =   240
      Left            =   10245
      Top             =   2070
      Width           =   240
   End
   Begin VB.Label lblData 
      Alignment       =   1  'Right Justify
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Serif"
         Size            =   6.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   210
      Index           =   3
      Left            =   8910
      TabIndex        =   7
      Top             =   6000
      Width           =   840
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   13
      Left            =   6750
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   6
      Left            =   6750
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   17
      Left            =   4935
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   15
      Left            =   3720
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   16
      Left            =   1290
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   14
      Left            =   2505
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   12
      Left            =   7230
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   11
      Left            =   7725
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   10
      Left            =   8220
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   9
      Left            =   8715
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   8
      Left            =   9210
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   5
      Left            =   7230
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   4
      Left            =   7725
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   3
      Left            =   8220
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   2
      Left            =   8715
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   1
      Left            =   9210
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Label lblData 
      Alignment       =   1  'Right Justify
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   210
      Index           =   1
      Left            =   9045
      TabIndex        =   9
      Top             =   2355
      Width           =   1350
   End
   Begin VB.Label lblData 
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   -1  'True
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00404040&
      Height          =   825
      Index           =   2
      Left            =   7905
      TabIndex        =   6
      Top             =   5145
      Width           =   2610
   End
   Begin VB.Label lblData 
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   210
      Index           =   0
      Left            =   7920
      TabIndex        =   5
      Top             =   2100
      Width           =   2340
   End
   Begin VB.Image imgMain 
      Height          =   2130
      Left            =   8145
      Top             =   2700
      Width           =   2130
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   0
      Left            =   9705
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgLast 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   0
      Left            =   10785
      Top             =   4845
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgLast 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   1
      Left            =   10785
      Top             =   1875
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   3
      Left            =   90
      Top             =   4845
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   1
      Left            =   1605
      Top             =   4845
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   0
      Left            =   3120
      Top             =   4845
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   2
      Left            =   4635
      Top             =   4845
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   4
      Left            =   6150
      Top             =   4845
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   7
      Left            =   1290
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   5
      Left            =   2505
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgDraw 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   0
      Left            =   10785
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   10
      Left            =   1605
      Top             =   1875
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   6
      Left            =   3720
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   8
      Left            =   4935
      Top             =   6420
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   12
      Left            =   90
      Top             =   1875
      Width           =   990
   End
   Begin VB.Image imgDraw 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   1
      Left            =   10785
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   13
      Left            =   6150
      Top             =   1875
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   9
      Left            =   3120
      Top             =   1875
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgCard 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   11
      Left            =   4635
      Top             =   1875
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Label lblMenu 
      Alignment       =   2  'Center
      BackStyle       =   0  'Transparent
      Caption         =   "Credits"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   11.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00004080&
      Height          =   315
      Index           =   1
      Left            =   10725
      TabIndex        =   0
      Top             =   3960
      Width           =   1080
   End
   Begin VB.Shape shp 
      BorderColor     =   &H000000FF&
      BorderWidth     =   5
      FillColor       =   &H0000FF00&
      Height          =   1485
      Index           =   0
      Left            =   90
      Tag             =   "0"
      Top             =   4815
      Visible         =   0   'False
      Width           =   300
   End
   Begin VB.Shape shp 
      BorderColor     =   &H000000FF&
      BorderWidth     =   5
      Height          =   1485
      Index           =   1
      Left            =   90
      Tag             =   "0"
      Top             =   1845
      Visible         =   0   'False
      Width           =   300
   End
   Begin VB.Image img 
      Appearance      =   0  'Flat
      Enabled         =   0   'False
      Height          =   3060
      Index           =   1
      Left            =   90
      Top             =   300
      Width           =   7545
   End
   Begin VB.Label lblLP 
      Alignment       =   2  'Center
      BackColor       =   &H80000008&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00004080&
      Height          =   255
      Index           =   1
      Left            =   3300
      TabIndex        =   3
      Top             =   60
      Width           =   630
   End
   Begin VB.Image img 
      Appearance      =   0  'Flat
      Enabled         =   0   'False
      Height          =   3060
      Index           =   0
      Left            =   90
      Top             =   4845
      Width           =   7545
   End
   Begin VB.Label lblLP 
      Alignment       =   2  'Center
      BackColor       =   &H80000008&
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00004080&
      Height          =   255
      Index           =   0
      Left            =   3300
      TabIndex        =   4
      Top             =   7920
      Width           =   630
   End
   Begin VB.Image imgHand 
      Appearance      =   0  'Flat
      Height          =   1485
      Index           =   7
      Left            =   9705
      Top             =   300
      Visible         =   0   'False
      Width           =   990
   End
   Begin VB.Image imgFrame 
      Appearance      =   0  'Flat
      Height          =   4455
      Left            =   7725
      Stretch         =   -1  'True
      Top             =   1875
      Width           =   2970
   End
   Begin VB.Label lblMsg 
      Alignment       =   2  'Center
      BackStyle       =   0  'Transparent
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   11.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   -1  'True
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00004080&
      Height          =   255
      Left            =   90
      TabIndex        =   1
      Top             =   3840
      Width           =   7050
   End
End
Attribute VB_Name = "frmMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private iCurrentPlayer As Integer
Private iCurrentHand As Integer
Private iCurrentTrap As Integer
Private Deck() As Integer
Private iCard() As Integer
Private iTribute As Integer
Private strFusion As String
Private iTmp(1) As Integer
Private iCount As Integer
Private iDraw As Integer
Private iComp As Integer
Private strCurrentPhase As String
Private strName(3) As String
Private strDeck(1) As String
Private strOpponent As String
Private strSpell As String
Private Type Card
  Frame As Integer
  Name As String
  Attribute As Integer
  Icon As String
  Type As String
  Description As String
  Level As Integer
  Cost As Integer
  Attack As Integer
  Defence As Integer
  Phase As String
  Spell As String
  Value As String
  Value2 As String
End Type

Private Sub Form_Load()
  Randomize
  iComp = 1
  strName(1) = "Bakura"
  strName(2) = "Marik"
  strName(3) = "Kaiba"
  strDeck(0) = "Player"
  strDeck(1) = strName(iComp)
  strOpponent = strName(iComp)
End Sub

Private Sub Form_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
  Drag_Form Me
End Sub

Private Sub imgField_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  If strSpell = "DeSpell" Then SendToTheGY 0, imgHand(iCurrentHand): SendToTheGY 1, imgField(1): lblMsg = "You play " & Get_Card(imgLast(0).Tag).Name & ".": strSpell = ""
End Sub

Private Sub imgFrame_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
  Drag_Form Me
End Sub

Private Sub imgMain_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
  Drag_Form Me
End Sub

Private Sub Chain_Link(iPlayer As Integer, strPhase As String)
Dim iOpponent As Integer
Dim varTemp As Variant
  
  iCurrentPlayer = iPlayer
  strCurrentPhase = strPhase
  iOpponent = IIf(iPlayer = 0, 1, 0)
  
  If iCurrentTrap > 4 And imgCard(iCurrentTrap).Tag <> "" Then SendToTheGY iOpponent, imgCard(iCurrentTrap): iCurrentTrap = 0
  Select Case strPhase
    Case "Start"
      lblMsg = IIf(iComp = 3, "Third", IIf(iComp = 2, "Second", "First")) & " Match. Defeat " & strOpponent & "."
      strCurrentPhase = "Next"
      Restart_Board
    
    Case "Draw"
      If iDraw = 0 Then GoTo goplay
      If imgDraw(iPlayer).Visible = False Then lblMsg = IIf(iPlayer = 0, "You", strOpponent) & " don't have any cards left to draw. " & IIf(iOpponent = 0, "You", strOpponent) & " win the game.": strCurrentPhase = "End": iCurrentPlayer = iOpponent: Exit Sub
      If iPlayer = 0 Then lblMsg = "Draw " & iDraw & " card" & IIf(iDraw > 1, "s", "") & " from your deck."
      If iPlayer = 1 Then lblMsg = "It's your opponent's turn.": Draw_Phase (iPlayer)
      lblOk.Visible = False
      
    Case "Play"
goplay:
      If iPlayer = 0 Then lblMsg = "Play Monster and/or Spell cards, you may also change its mode.": lblOk.Visible = True
      If iPlayer = 1 Then If Comp_Play = True Then Comp_Position: strCurrentPhase = "Battle"

    Case "Battle"
      If iPlayer = 0 Then lblMsg = "Select 1 monster to attack with, and the monster you wish to attack."
      If iPlayer = 1 Then Comp_Select: lblMsg = strOpponent & " is ready to attack."
      If Count_Cards(iPlayer, "Attack") = 0 Or iCard(iOpponent) = 0 Then GoTo gonext
      If Count_Cards(iOpponent) = 0 Then img(iOpponent).Enabled = True
      strCurrentPhase = "Outcome"
      
    Case "Outcome"
      If lblLP(iPlayer).Tag = "" Or lblLP(iOpponent).Tag = "" Then GoTo gonext Else If Activate_Spell(iOpponent) = True Then Exit Sub
      If lblLP(iPlayer).Tag = "" Or lblLP(iOpponent).Tag = "" Then GoTo gonext Else Damage_Step iPlayer, iOpponent, CInt(shp(iPlayer).Tag) - CInt(shp(iOpponent).Tag), IIf(shp(iOpponent).Visible = False, 0, shp(iOpponent).Height)
      Deselect_Cards
      
    Case "Next"
gonext:
     If imgField(iOpponent).Tag <> "" Then
       If imgField(iOpponent).Picture = imlFrames.ListImages(4).Picture And imgField(iPlayer).Tag <> "" Then SendToTheGY iPlayer, imgField(iPlayer)
       Card_Mode imgField(iOpponent), "Atk_"
     End If
     If iPlayer = 0 Then If Count_Hand(0) > 6 Then lblMsg = "Discard 1 card to the Graveyard.": strSpell = "Discard": lblOk.Visible = False: Exit Sub
     If iPlayer = 1 Then If Count_Hand(1) > 6 Then SendToTheGY 1, imgHand(7)
     tmrComp.Enabled = IIf(iPlayer = 0, True, False)
     iDraw = IIf(iCard(iOpponent) = 0, 5, 1)
     If iOpponent = 0 Then iCount = 1
     Chain_Link iOpponent, "Draw"
     Deselect_Cards

    Case "End"
      iComp = IIf(iPlayer = 0, iComp + 1, 1)
      lblOk.Visible = IIf(iPlayer = 0, True, False)
      lblMsg = IIf(iPlayer = 0, "You Win", strOpponent & " wins") & " the game!"
      If iPlayer = 0 And iComp = 4 Then
        lblMsg = "You Win. You get a New Card!"
        varTemp = Split(ReadINI("Deck", "Cards", App.Path & "/Player.dek"), "|")
        varTemp(0) = varTemp(0) + IIf(varTemp(0) < 29, 1, 0)
        WriteINI "Deck", "Cards", Join(varTemp, "|"), App.Path & "/Player.dek"
      End If
      If iComp = 4 Then iComp = 1: lblOk.Visible = False
      strOpponent = strName(iComp)
      strDeck(1) = strName(iComp)
      strCurrentPhase = "Start"
      tmrComp.Enabled = False
      iCurrentPlayer = 1
  End Select
End Sub

Private Sub Restart_Board()
  For i% = 0 To 79
    If i% < 2 Then imgLast(i%).Visible = False: imgDraw(i%).Visible = True: imgDraw(i%).Picture = imlFrames.ListImages(4).Picture: lblLP(i%) = "8000"
    If i% < 2 Then imgField(i%).Visible = False: imgField(i%).Tag = ""
    If i% < 14 Then imgHand(i%).Visible = False: imgHand(i%).Tag = ""
    If i% < 18 Then imgCard(i%).Visible = False: imgCard(i%).Tag = ""
    imgGY(i%).Visible = False
    imgGY(i%).Tag = ""
  Next i%
  ReDim Deck(1, 39)
  ReDim iCard(1)
  Deselect_Cards
  Hide_Preview
End Sub

Private Sub Draw_Phase(iPlayer As Integer)
  If strCurrentPhase <> "Draw" Or iPlayer <> iCurrentPlayer Then Exit Sub
  
  If iCard(iPlayer) = 39 Then imgDraw(iPlayer).Visible = False
  If iDraw = 1 Then strCurrentPhase = "Play"
  Free_Hand iPlayer, Shuffle_Deck(iPlayer)
  iCard(iPlayer) = iCard(iPlayer) + 1
  iDraw = iDraw - 1
End Sub

Private Sub Play_Phase(iPlayer As Integer, iHand As Integer)
Dim bTribute As Boolean
Dim iSide As Integer
Dim crdCard As Card

  iCurrentHand = iHand
  crdCard = Get_Card(imgHand(iHand).Tag)
  iSide = IIf(crdCard.Frame > 2, 0, 5) + (iPlayer * 9)
  If strCurrentPhase <> "Play" Or iPlayer <> iCurrentPlayer Then Exit Sub
  If iPlayer = 0 Then
    If crdCard.Frame > 2 And iCount = 0 Then lblMsg = "You can play only 1 monster card during your turn.": Exit Sub
    If crdCard.Cost > iTribute Then strSpell = "Tribute": lblMsg = "Offer " & crdCard.Cost & " of your monsters on the field to summon " & crdCard.Name & ".": Exit Sub
    If crdCard.Frame > 2 And iCount > 0 Then iCount = iCount - 1
    If crdCard.Cost = iTribute And iTribute > 0 Then bTribute = True: iTribute = 0
  End If
  
  If crdCard.Icon = "Field" Then
    If imgField(iPlayer).Tag <> "" Then SendToTheGY iPlayer, imgField(iPlayer)
    Replace_Card iPlayer, imgField(iPlayer), imgHand(iHand): Card_Mode imgField(iPlayer), "Down": lblMsg = IIf(iPlayer = 0, "You play ", strOpponent & " plays ") & crdCard.Name & ".": Exit Sub
  End If
  
  For i% = iSide To iSide + IIf(iSide = 5 Or iSide = 14, 3, 4)
    If imgCard(i%).Tag = "" Then
      lblMsg = IIf(iPlayer = 0, "You play " & crdCard.Name, strOpponent & " sets " & IIf(crdCard.Frame > 2, "a Monster Card", "a " & crdCard.Type & " Card")) & "."
      If crdCard.Frame <> 2 Then If Spell_Checker(iPlayer, imgHand(iHand).Tag, strCurrentPhase) = True Then Exit For
      Replace_Card iPlayer, imgCard(i%), imgHand(iHand)
      If crdCard.Frame > 2 Then Card_Mode imgCard(i%), IIf(bTribute = False, "Across", "")
      If crdCard.Frame < 3 Then Card_Mode imgCard(i%), IIf(crdCard.Type = "Trap", "Down", IIf(crdCard.Icon = "Continuous" Or crdCard.Icon = "Counter" Or crdCard.Type = "", "", "Down"))
      If crdCard.Frame > 2 Then Activate_Spell IIf(iPlayer = 0, 1, 0), imgCard(i%)
      Exit For
    End If
  Next i%
End Sub

Private Function Activate_Spell(iPlayer As Integer, Optional objCard As Object) As Boolean
  For i% = IIf(iPlayer = 0, 5, 14) To IIf(iPlayer = 0, 8, 17)
    If imgCard(i%).Tag <> "" Then If Spell_Checker(iPlayer, imgCard(i%).Tag, strCurrentPhase, objCard) = True Then Card_Mode imgCard(i%), "Atk_": Activate_Spell = True: iCurrentTrap = i%: Exit For
  Next i%
End Function

Private Sub Damage_Step(iPlayer As Integer, iOpponent As Integer, iDiff As Integer, iMode As Integer)
Dim iPDiff As Integer

  iPDiff = iDiff * IIf(iDiff < 0, -1, 1)
  If imgCard(iTmp(iOpponent)).Tag <> "" And shp(0).Visible = True And shp(1).Visible = True Then Card_Mode imgCard(iTmp(iOpponent)), IIf(imgCard(iTmp(iOpponent)).Height = 99, "Atk_", "Def_")
  If shp(0).Visible = False Or shp(1).Visible = False Then lblLP(iOpponent) = lblLP(iOpponent) - iPDiff: lblMsg = IIf(iOpponent = 0, "You've", strOpponent & " has") & " been dealt " & iPDiff & " damage."
  
  If iDiff = 0 And iMode = 66 Then lblMsg = "Deuce.": Exit Sub
  If iDiff = 0 And iMode = 99 Then SendToTheGY iPlayer, imgCard(iTmp(iPlayer)): SendToTheGY iOpponent, imgCard(iTmp(iOpponent)): lblMsg = "Both monsters go to their owner's Graveyards."
  If iDiff > 0 And iMode = 66 Then SendToTheGY iOpponent, imgCard(iTmp(iOpponent)): lblMsg = "Monsters deal their combat damage."
  If iDiff > 0 And iMode = 99 Then SendToTheGY iOpponent, imgCard(iTmp(iOpponent)): lblLP(iOpponent) = lblLP(iOpponent) - iPDiff: lblMsg = IIf(iPlayer = 1, "You've", strOpponent & " has") & " been dealt " & iPDiff & " damage."
  If iDiff < 0 And iMode = 66 Then lblLP(iPlayer) = lblLP(iPlayer) - iPDiff: lblMsg = IIf(iPlayer = 0, "You've", strOpponent & " has") & " been dealt " & iPDiff & " damage."
  If iDiff < 0 And iMode = 99 Then SendToTheGY iPlayer, imgCard(iTmp(iPlayer)): lblLP(iPlayer) = lblLP(iPlayer) - iPDiff: lblMsg = IIf(iPlayer = 0, "You've", strOpponent & " has") & " been dealt " & iPDiff & " damage."
  If CInt(lblLP(iPlayer).Caption) <= 0 Then lblLP(iPlayer) = 0: Chain_Link iOpponent, "End": Exit Sub
  If CInt(lblLP(iOpponent).Caption) <= 0 Then lblLP(iOpponent) = 0: Chain_Link iPlayer, "End": Exit Sub
  strCurrentPhase = "Next"
 End Sub

Private Function Comp_Play() As Boolean
Dim iPlay As Integer, iTrap As Integer, iMagic As Integer, iMon As Integer, iTrib As Integer
Static iCase As Integer

checkagain:
  For i% = 7 To 13
    If imgHand(i%).Tag <> "" Then
      If Get_Card(imgHand(i%).Tag).Type = "Trap" Then iTrap = i%
      If Get_Card(imgHand(i%).Tag).Type = "Magic" And CInt(Rnd * 1) = 0 Then iMagic = i%
      If Get_Card(imgHand(i%).Tag).Cost > 0 And CInt(Rnd * 1) = 0 Then iTrib = i%
      If Get_Card(imgHand(i%).Tag).Cost = 0 And Get_Card(imgHand(i%).Tag).Frame > 2 Then iMon = i%
    End If
  Next i%
  
  If iCase = 0 Then iPlay = iMagic
  If iCase = 1 Then If iTrib > 0 Then If Comp_Discard(iTrib, Get_Card(imgHand(iTrib).Tag).Cost) = True Then iCase = 4: imgHand(iTrib).Visible = False: imgHand(iTrib).Tag = "": Rearrange_Hand 1
  If iCase = 2 Then iPlay = iMon
  If iCase = 3 And Count_Cards(1) > 0 Then iPlay = iTrap
  If iCase = 4 Then iCase = 0: Comp_Play = True: Exit Function
  iCase = iCase + 1
  If iPlay > 0 Then Play_Phase 1, iPlay Else iPlay = 0: GoTo checkagain
End Function

Private Sub Comp_Position()
Dim crdCard As Card

  If Count_Cards(1) = 1 Then Exit Sub
  For i% = 9 To 13
    If imgCard(i%).Tag <> "" Then crdCard = Get_Card(imgCard(i%).Tag): Card_Mode imgCard(i%), IIf(crdCard.Attack - crdCard.Defence > 900 Or crdCard.Attack > 1800, "Atk_", IIf(imgCard(i%).Height = 99, "Def_", ""))
  Next i%
End Sub

Private Function Comp_Discard(iNum As Integer, iCost As Integer) As Boolean
Dim iTotal As Integer
  
  Comp_Discard = True
  For i% = 9 To 13
    If imgCard(i%).Tag <> "" Then If Get_Card(imgCard(i%).Tag).Cost < iCost Then iTotal = iTotal + 1
  Next i%
  
  If iCost > iTotal Then Comp_Discard = False: Exit Function
  For i% = 9 To 13
    If imgCard(i%).Tag <> "" And iCost > 0 Then If Get_Card(imgCard(i%).Tag).Cost < iCost Then SendToTheGY 1, imgCard(i%): iCost = iCost - 1
  Next i%
  
  For i% = 9 To 13
    If imgCard(i%).Tag = "" Then imgCard(i%).Tag = imgHand(iNum).Tag: imgCard(i%).Visible = True: Card_Mode imgCard(i%), "Atk_": lblMsg = strOpponent & " summons " & Get_Card(imgCard(i%).Tag).Name & ".": Exit For
  Next i%
End Function

Private Sub Comp_Select()
Dim crdCard As Card
Dim iPoints As Integer, iAtk(1) As Integer, iX(1) As Integer
  
  For i% = 1 To 0 Step -1
    For a% = (i% * 9) To (i% * 9) + 4
      If imgCard(a%).Tag <> "" Then
        iPoints = IIf(imgCard(a%).Height = 99 Or i% = 1, Get_Card(imgCard(a%).Tag).Attack, Get_Card(imgCard(a%).Tag).Defence)
        If i% = 1 Then If iPoints > iAtk(1) Then iAtk(1) = iPoints: iX(1) = a%
        If i% = 0 Then If (iPoints + 100) < iAtk(1) And iPoints > iAtk(0) Then iAtk(0) = iPoints: iX(0) = a%
        If i% = 1 And iAtk(0) = 0 And Count_Cards(0) > 0 Then Card_Mode imgCard(a%), IIf(imgCard(a%).Height = 99, "Def_", "")
      End If
    Next a%
  Next i%
  
  If iAtk(0) > 0 Or Count_Cards(0) = 0 Then If imgCard(iX(1)).Tag <> "" Then Card_Mode imgCard(iX(1)), "Atk_": Select_Card iX(1), iAtk(1), 1
  If iAtk(0) > 0 Then Select_Card iX(0), iAtk(0), 0
  If Count_Cards(0) = 0 Then img_Click 0
End Sub

Private Sub Free_Hand(iPlayer As Integer, iNum As Integer)
  For i% = iPlayer * 7 To (iPlayer * 7) + 6
    If imgHand(i%).Tag = "" Then
      imgHand(i%).Tag = iNum
      imgHand(i%).Visible = True
      If iPlayer = 1 Then imgHand(i%).Picture = imgDraw(iPlayer).Picture Else Card_Mode imgHand(i%), "Atk_"
      Exit For
    End If
  Next i%
End Sub

Private Sub Free_Cards(iPlayer As Integer, sNum As String)
  For i% = (iPlayer * 9) To (iPlayer * 9) + 4
    If imgCard(i%).Tag = "" Then
      imgCard(i%).Tag = sNum
      imgCard(i%).Visible = True
      Card_Mode imgCard(i%), "Atk_"
      Exit For
    End If
  Next i%
End Sub

Private Sub Select_Card(Index As Integer, iPoints As Integer, iPlayer As Integer, Optional strShp As String)
If shp(iPlayer).Visible = True Then Exit Sub
  shp(iPlayer).Height = imgCard(Index).Height
  shp(iPlayer).Left = imgCard(Index).Left
  lblLP(iPlayer).Tag = "Battle"
  shp(iPlayer).Visible = IIf(strShp <> "", False, True)
  shp(iPlayer).Tag = iPoints
  iTmp(iPlayer) = Index
  If imgField(0).Tag <> "" And imgField(0).Picture <> imlFrames.ListImages(4).Picture Or imgField(1).Tag <> "" And imgField(1).Picture <> imlFrames.ListImages(4).Picture Then Spell_Checker iPlayer, IIf(imgField(0).Tag <> "", imgField(0).Tag, imgField(1).Tag), "Field"
End Sub

Private Function Spell_Checker(iPlayer As Integer, strCard As String, strPhase As String, Optional objCard As Object) As Boolean
Dim iOpponent As Integer, iVal As Integer, iVPoints As Integer
Dim varType As Variant
Dim strFuse As String
Dim crdCard As Card
  
  iOpponent = IIf(iPlayer = 0, 1, 0)
  crdCard = Get_Card(strCard)
  strSpell = crdCard.Spell
  If crdCard.Phase <> strPhase Then Exit Function
  
  lblMsg = IIf(iPlayer = 0, "You play ", strOpponent & " plays ") & crdCard.Name & "."
  If crdCard.Value2 = "Negate" And shp(iPlayer).Tag > shp(iOpponent).Tag Then Exit Function
  Select Case strSpell
    Case "Draw"
      iDraw = CInt(crdCard.Value)
      Chain_Link iPlayer, "Draw"
      
    Case "Fusion"
      strFusion = ""
      If iPlayer = 0 Then
        lblMsg = "Select 2 Fusion-material monsters on the field."
        Spell_Checker = True
      Else
        For i% = 9 To 13
          For a% = 9 To 13
            If imgCard(i%).Tag <> "" And imgCard(a%).Tag <> "" Then
              strFuse = IIf(imgCard(a%).Tag > imgCard(i%).Tag, imgCard(i%).Tag & "+" & imgCard(a%).Tag, imgCard(a%).Tag & "+" & imgCard(i%).Tag)
              If ReadINI("Cards", strFuse, App.Path & "/images/set.mds") <> "" Then SendToTheGY 1, imgCard(i%): SendToTheGY 1, imgCard(a%): Free_Cards 1, strFuse: GoTo goout
            End If
            If a% = 13 Then Spell_Checker = True
          Next a%
        Next i%
      End If
    
    Case "Shadow"
      Card_Mode objCard, "Atk_"
      
    Case "Increase"
      If imgCard(iTmp(iPlayer)).Height = 66 And imgCard(iTmp(iPlayer)).Tag <> "" And CInt(shp(iPlayer).Tag) + crdCard.Value >= CInt(shp(iOpponent).Tag) Then Card_Mode imgCard(iTmp(iPlayer)), "Def_": shp(iPlayer).Tag = CInt(shp(iPlayer).Tag) + crdCard.Value Else Exit Function
    
    Case "TrapHole"
      If Get_Card(objCard.Tag).Attack > crdCard.Value Then SendToTheGY iOpponent, objCard Else Exit Function
      
    Case "Handle"
      If iPlayer = 0 Then
        lblMsg = "Select 1 of your opponent's Magic or Trap cards on the field."
        Spell_Checker = True
      Else
        For i% = 0 To 4
          If imgCard(i%).Tag <> "" Then
            For e% = 0 To 6
              If imgHand(e%).Tag = "" Then Replace_Card 0, imgHand(e%), imgCard(i%): Exit For
            Next e%
            Exit For
          End If
        Next i%
      End If
    
    Case "Mirror"
      For i% = 0 To 4
        If iPlayer = 1 And imgCard(i%).Tag <> "" And imgCard(i%).Height = 99 Then SendToTheGY 0, imgCard(i%)
        If iPlayer = 0 And imgCard(i% + 9).Tag <> "" And imgCard(i% + 9).Height = 99 Then SendToTheGY 1, imgCard(i% + 9)
      Next i%
        
    Case "Hole"
      If iPlayer = 1 And Count_Cards(1) > Count_Cards(0) Then Spell_Checker = True: GoTo goout
      lblMsg = lblMsg & " All monsters on the field go to the Graveyard."
      For i% = 0 To 4
        If imgCard(i%).Tag <> "" Then SendToTheGY 0, imgCard(i%)
        If imgCard(i% + 9).Tag <> "" Then SendToTheGY 1, imgCard(i% + 9)
      Next i%

    Case "Restore", "Damage"
      iVal = IIf(crdCard.Value = "OppAtk", shp(iOpponent).Tag, crdCard.Value)
      lblLP(IIf(strSpell = "Restore", iPlayer, iOpponent)) = lblLP(IIf(strSpell = "Restore", iPlayer, iOpponent)) + (iVal * IIf(strSpell = "Restore", 1, -1))
      If strSpell = "Restore" Then lblMsg = lblMsg & IIf(iPlayer = 0, " You gain ", " He gains ") & iVal & " points."
      If strSpell = "Damage" Then lblMsg = lblMsg & IIf(iPlayer = 1, " You've", " " & strOpponent & " has") & " been dealt " & iVal & " damage."
      If lblLP(iOpponent) <= 0 Then lblLP(iOpponent) = 0: strCurrentPhase = "End": iCurrentPlayer = iPlayer
          
    Case "Fissure"
Dim iPoints As Integer
      iPoints = 9999
      For i% = (iOpponent * 9) To (iOpponent * 9) + 4
        If imgCard(i%).Tag <> "" Then If Get_Card(imgCard(i%).Tag).Attack < iPoints And imgCard(i%).Picture <> imlFrames.ListImages(5).Picture Then iPoints = Get_Card(imgCard(i%).Tag).Attack: iVal = i%
      Next i%
      If iPoints < 9999 Then SendToTheGY iOpponent, imgCard(iVal) Else Spell_Checker = True
      
    Case "Retrieve"
      If iPlayer = 0 Then lblMsg = "Select 1 monster card from your Graveyard.": Graveyard(0).Top = img(0).Top - 8: Graveyard(1).Top = img(1).Top - 8: Spell_Checker = True
      If iPlayer = 1 Then
        For i% = 1 To 79
          If imgGY(i%).Tag <> "" Then If Get_Card(imgGY(i%).Tag).Frame > 2 And Get_Card(imgGY(i%).Tag).Attack > iVPoints Then iVal = i%: iVPoints = Get_Card(imgGY(i%).Tag).Attack
        Next i%
        For i% = 9 To 13
          If imgCard(i%).Tag = "" And iVal > 0 Then Replace_Card 1, imgCard(i%), imgGY(iVal): Exit For
          If i% = 13 Then Spell_Checker = True
        Next i%
      End If
    
    Case "DeSpell"
      If iPlayer = 0 Then lblMsg = "Select 1 of your opponent's spell cards.": Spell_Checker = True
      For i% = IIf(strSpell = "DeSpell", 5, 0) To IIf(strSpell = "DeSpell", 8, 4)
        If iPlayer = 1 And imgCard(i%).Tag <> "" Then SendToTheGY 0, imgCard(i%): Exit For
        If iPlayer = 1 And i% = IIf(strSpell = "DeSpell", 8, 4) Then Spell_Checker = True
      Next i%
    
    Case "Attack", "Defence"
      If iPlayer = 0 Then lblMsg = "Select 1 of your opponent's monster cards.": Spell_Checker = True
      For i% = 0 To 4
        If imgCard(i%).Tag <> "" Then iVal = IIf(Get_Card(imgCard(i%).Tag).Attack - Get_Card(imgCard(i%).Tag).Defence > 0, 1, 0)
        If iPlayer = 1 And imgCard(i%).Tag <> "" And imgCard(i%).Height = IIf(strSpell = "Attack", 66, 99) And Count_Cards(1) > 1 And iTemp = IIf(strSpell = "Defence", 1, 0) Then Card_Mode imgCard(i%), IIf(strSpell = "Attack", "Atk_", "Def_"): lblMsg = strOpponent & " Switch 1 of your monster cards.": Exit For
        If iPlayer = 1 And i% = 4 Then Spell_Checker = True
      Next i%
      
    Case "Upgrade"
      varType = Split(crdCard.Value, "/")
      For i% = 0 To UBound(varType)
        If imgCard(iTmp(iPlayer)).Tag <> "" And shp(iPlayer).Visible = True Then If Get_Card(imgCard(iTmp(iPlayer)).Tag).Type = varType(i%) Or Get_Card(imgCard(iTmp(iPlayer)).Tag).Attribute = varType(i%) Or varType(i%) = "Any" Then shp(iPlayer).Tag = shp(iPlayer).Tag + IIf(imgCard(iTmp(iPlayer)).Height = 99, crdCard.Attack, crdCard.Defence)
      Next i%
      varType = Split(crdCard.Value2, "/")
      For i% = 0 To UBound(varType)
        If imgCard(iTmp(iPlayer)).Tag <> "" And shp(iPlayer).Visible = True Then If Get_Card(imgCard(iTmp(iPlayer)).Tag).Type = varType(i%) Or Get_Card(imgCard(iTmp(iPlayer)).Tag).Attribute = varType(i%) Or varType(i%) = "Any" Then shp(iPlayer).Tag = shp(iPlayer).Tag - IIf(imgCard(iTmp(iPlayer)).Height = 99, crdCard.Attack, crdCard.Defence)
      Next i%
    End Select
goout:
  If crdCard.Value2 = "Negate" Then Deselect_Cards
  If crdCard.Frame = 2 Then Spell_Checker = True: Exit Function
  If crdCard.Frame = 1 And crdCard.Icon <> "Equip" And crdCard.Icon <> "Continuous" And crdCard.Icon <> "Field" And Spell_Checker = False Then SendToTheGY iPlayer, imgHand(iCurrentHand): Spell_Checker = True: strSpell = ""
End Function

Private Sub SendToTheGY(iPlayer As Integer, objCard As Object)
  Replace_Card iPlayer, imgLast(iPlayer), objCard
  Card_Mode imgLast(iPlayer), "Atk_"
  
  For i% = (iPlayer * 40) To (iPlayer * 40) + 39
    If imgGY(i%).Tag = "" Then imgGY(i%).Tag = imgLast(iPlayer).Tag: imgGY(i%).Visible = True: Card_Mode imgGY(i%), "Atk_": Exit For
  Next i%
End Sub

Private Sub Graveyard_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  Graveyard(0).Top = 600
  Graveyard(1).Top = 600
End Sub

Private Sub img_Click(Index As Integer)
  Select_Card 0, 0, Index, "False"
  lblLP(Index).ForeColor = vbRed
End Sub

Private Sub imgCard_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
Dim strMonFusion As String
  If iCurrentPlayer = 1 Then Exit Sub
  Select Case Index
    Case Is > 13 Or Index > 4 And Index < 9
      If strSpell = "DeSpell" Then SendToTheGY 0, imgHand(iCurrentHand): SendToTheGY IIf(Index > 13, 1, 0), imgCard(Index): lblMsg = "You play " & Get_Card(imgLast(0).Tag).Name & ".": strSpell = ""
      If strSpell = "Handle" And Index > 13 Then
        For i% = 7 To 13
          If imgHand(i%).Tag = "" Then Replace_Card 1, imgHand(i%), imgCard(Index): SendToTheGY 0, imgHand(iCurrentHand): lblMsg = "You play " & Get_Card(imgLast(0).Tag).Name & ".": strSpell = "": Exit For
        Next i%
      End If
      
    Case Is > 8 And Index < 14
      If strCurrentPhase = "Outcome" Then Select_Card Index, IIf(imgCard(Index).Height = 99, Get_Card(imgCard(Index).Tag).Attack, Get_Card(imgCard(Index).Tag).Defence), 1: Exit Sub
      If strSpell = "Attack" And imgCard(Index).Height = 66 Then SendToTheGY 0, imgHand(iCurrentHand): Card_Mode imgCard(Index), "Atk_": lblMsg = "You play " & Get_Card(imgLast(0).Tag).Name & ".": strSpell = ""
      If strSpell = "Defence" And imgCard(Index).Height = 99 Then SendToTheGY 0, imgHand(iCurrentHand): Card_Mode imgCard(Index), "Def_": lblMsg = "You play " & Get_Card(imgLast(0).Tag).Name & ".": strSpell = ""
      
    Case Is < 5
      If strSpell = "Fusion" And strFusion = "" Then strFusion = Index: Exit Sub
      If strSpell = "Fusion" Then
        strMonFusion = IIf(imgCard(CInt(strFusion)).Tag > imgCard(Index).Tag, imgCard(Index).Tag & "+" & imgCard(CInt(strFusion)).Tag, imgCard(CInt(strFusion)).Tag & "+" & imgCard(Index).Tag)
        If ReadINI("Cards", strMonFusion, App.Path & "\images\set.mds") <> "" Then SendToTheGY 0, imgCard(CInt(strFusion)): SendToTheGY 0, imgCard(Index): Free_Cards 0, strMonFusion: SendToTheGY 0, imgHand(iCurrentHand): lblMsg = "You summoned " & Get_Card(strMonFusion).Name & ".": strSpell = "": Exit Sub
      End If
      If strCurrentPhase = "Play" Then Card_Mode imgCard(Index), IIf(imgCard(Index).Height = 66, "Atk_", "Def_")
      If strCurrentPhase = "Outcome" And imgCard(Index).Height = 99 Then Select_Card Index, Get_Card(imgCard(Index).Tag).Attack, 0: Exit Sub
      If strSpell = "Tribute" Then SendToTheGY 0, imgCard(Index): iTribute = iTribute + 1: strCurrentPhase = "Play": Play_Phase 0, iCurrentHand
  End Select
End Sub

Private Sub Replace_Card(iPlayer As Integer, objCard As Object, objWith As Object)
  objCard.Picture = objWith.Picture
  objCard.Tag = objWith.Tag
  objWith.Visible = False
  objCard.Visible = True
  objWith.Tag = ""
  Rearrange_Hand iPlayer
End Sub

Private Function Shuffle_Deck(iPlayer As Integer) As Integer
Dim iRandom As Integer
Dim varData As Variant

  varData = Split(ReadINI("Deck", "Cards", App.Path & "\" & strDeck(iPlayer) & ".dek"), "|")
  
  For i% = 0 To 39
    If i% = 0 Then iRandom = CInt(Rnd * 39) + 1
    If Deck(iPlayer, i%) = iRandom Then i% = -1
    If i% > -1 Then If Deck(iPlayer, i%) = 0 Then Deck(iPlayer, i%) = iRandom: Shuffle_Deck = varData(iRandom): Exit For
  Next i%
End Function

Private Sub imgHand_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  If strSpell = "Discard" Then strSpell = "": SendToTheGY iCurrentPlayer, imgHand(Index): Chain_Link iCurrentPlayer, "Next": Exit Sub
  Play_Phase 0, Index
End Sub

Private Sub imgDraw_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  If strCurrentPhase <> "Draw" Or iCurrentPlayer <> 0 Then Exit Sub Else Draw_Phase 0
  If iDraw = 0 Then Chain_Link 0, "Play"
End Sub

Private Sub Deselect_Cards()
  For i% = 0 To 1
    lblLP(i%).ForeColor = &H4080&
    shp(i%).Visible = False
    img(i%).Enabled = False
    lblLP(i%).Tag = ""
  Next i%
End Sub

Private Sub imgGY_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  Graveyard(0).Top = 600
  Graveyard(1).Top = 600
  If strSpell <> "Retrieve" Or Get_Card(imgGY(Index).Tag).Frame < 3 Then Exit Sub
  lblMsg = "You retrieve " & Get_Card(imgGY(Index).Tag).Name & " from your Graveyard."
  SendToTheGY 0, imgHand(iCurrentHand): strSpell = ""
  For i% = 0 To 4
    If imgCard(i%).Tag = "" Then Replace_Card 0, imgCard(i%), imgGY(Index): Exit For
  Next i%
End Sub

Private Sub tmrComp_Timer()
  tmrComp.Interval = IIf(strCurrentPhase = "Draw", 1000, 2100)
  Chain_Link iCurrentPlayer, strCurrentPhase
End Sub

Private Sub lblOk_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  strCurrentPhase = IIf(strCurrentPhase = "Play", "Battle", strCurrentPhase)
  Chain_Link iCurrentPlayer, strCurrentPhase
  lblOk = "[ Continue ]"
End Sub

Private Sub lblOk_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
  lblOk = "[  Continue  ]"
End Sub

Private Sub imgCard_MouseMove(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Index > 8 Then
    If imgCard(Index).Picture = imlFrames.ListImages(4).Picture Then Hide_Preview "Back": Exit Sub
    If imgCard(Index).Picture = imlFrames.ListImages(5).Picture Then Hide_Preview "Back": Exit Sub
  End If
  Show_Preview imgCard(Index).Tag
End Sub

Private Sub imgHand_MouseMove(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Index > 6 Then Hide_Preview "Back" Else Show_Preview imgHand(Index).Tag
End Sub

Private Sub imgField_MouseMove(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  Show_Preview imgField(Index).Tag
End Sub

Private Sub imgGY_MouseMove(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  Show_Preview imgGY(Index).Tag
End Sub

Private Sub imgLast_MouseMove(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  Show_Preview imgLast(Index).Tag
End Sub

Private Sub imgLast_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  Graveyard(Index).Top = IIf(Graveyard(Index).Top < 600, 600, img(Index).Top - 8)
  Graveyard(IIf(Index = 0, 1, 0)).Top = 600
  strSpell = ""
End Sub

Private Sub Show_Preview(strCard As String, Optional strCase As String)
Dim crdCard As Card

  If strCard = imgMain.Tag Or strCard = "" Then Exit Sub
  crdCard = Get_Card(strCard)
  imgMain.Tag = strCard
  lblData(0) = crdCard.Name
  lblData(1) = IIf(crdCard.Frame > 2, "", "[ " & crdCard.Type & " Card" & IIf(crdCard.Icon <> "", "      ]", " ]"))
  lblData(2) = crdCard.Description
  lblData(3) = IIf(crdCard.Frame > 2, "ATK/ " & crdCard.Attack, "")
  lblData(4) = IIf(crdCard.Frame > 2, "DEF/ " & crdCard.Defence, "")
  lblData(2).Height = IIf(crdCard.Frame > 2, 55, 72)
  lblData(2).Top = IIf(crdCard.Frame > 2, 343, 333)
  lblData(5) = IIf(crdCard.Frame > 2, "[" & crdCard.Type & "]", "")
  
  For i% = 0 To 9: imgStar(i%).Visible = IIf(crdCard.Level > i%, True, False): imgStar(i%).Picture = imlIcons.ListImages(9).Picture: Next i%
  If crdCard.Icon <> "" Then imgStar(0).Picture = imlIcons.ListImages(Switch(crdCard.Icon = "Continuous", 10, crdCard.Icon = "Counter", 11, crdCard.Icon = "Equip", 12, crdCard.Icon = "Field", 13, crdCard.Icon = "Quick", 14, crdCard.Icon = "Ritual", 15)).Picture: imgStar(0).Visible = True
  imgIcon.Picture = imlIcons.ListImages(crdCard.Attribute).Picture
  imgFrame.Picture = imlFrames.ListImages(crdCard.Frame).Picture
  imgMain.Picture = LoadPicture(App.Path & "\images\" & crdCard.Name & ".jpg")
End Sub

Private Sub Hide_Preview(Optional strCard As String)
  lblData(0) = ""
  lblData(1) = ""
  lblData(2) = ""
  lblData(3) = ""
  lblData(4) = ""
  lblData(5) = ""
  
  For i% = 0 To 9: imgStar(i%).Visible = False: Next i%
  If strCard <> "" Then imgFrame.Picture = imlFrames.ListImages(6).Picture Else imgFrame.Picture = LoadPicture()
  If strCard = "Back" Then imgFrame.Picture = imlFrames.ListImages(7).Picture
  imgIcon.Picture = LoadPicture()
  imgMain.Picture = LoadPicture()
  imgMain.Tag = 0
End Sub

Private Function Get_Card(strCard As String) As Card
Dim varData As Variant
  
  varData = Split(ReadINI("Cards", strCard, App.Path & "\images\set.mds"), "|")
  
  With Get_Card
    .Frame = varData(0)
    .Name = varData(1)
    .Attribute = varData(2)
    .Icon = varData(3)
    .Type = varData(4)
    .Description = varData(5)
    If varData(6) = "" Then .Level = 0 Else .Level = varData(6)
    If varData(7) = "" Then .Cost = 0 Else .Cost = varData(7)
    If varData(8) = "" Then .Attack = 0 Else .Attack = varData(8)
    If varData(9) = "" Then .Defence = 0 Else .Defence = varData(9)
    .Phase = varData(10)
    .Spell = varData(11)
    .Value = varData(12)
    .Value2 = varData(13)
  End With
End Function

Private Sub Card_Mode(objCard As Object, strMode As String)
  If strMode = "Atk_" Or strMode = "Def_" Then objCard.Picture = LoadPicture(App.Path & "\images\" & strMode & Get_Card(objCard.Tag).Name & ".jpg")
  If strMode = "Down" Or strMode = "Across" Then objCard.Picture = imlFrames.ListImages(IIf(strMode = "Down", 4, 5)).Picture
End Sub

Private Function Count_Hand(iPlayer As Integer) As Integer
Dim iHand As Integer
  
  For i% = (iPlayer * 7) To (iPlayer * 7) + 6
    If imgHand(i%).Tag <> "" Then iHand = iHand + 1
  Next i%
  Count_Hand = iHand
End Function

Private Function Count_Cards(iPlayer As Integer, Optional strMode As String) As Integer
Dim iMons As Integer
  
  For i% = (iPlayer * 9) To (iPlayer * 9) + 4
    If imgCard(i%).Tag <> "" Then iMons = iMons + IIf(imgCard(i%).Height = 66 And strMode = "Attack", 0, 1)
  Next i%
  Count_Cards = iMons
End Function

Private Sub Rearrange_Hand(iPlayer As Integer)
  For i% = (iPlayer * 7) + 5 To (iPlayer * 7) Step -1
    If imgHand(i%).Tag = "" And imgHand(i% + 1).Tag <> "" Then Replace_Card iPlayer, imgHand(i%), imgHand(i% + 1): i% = (iPlayer * 7) + 6
  Next i%
End Sub

Private Sub lblMenu_MouseMove(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  For i% = 0 To 2
    lblMenu(i%).FontBold = IIf(i% = Index, True, False)
  Next i%
End Sub

Private Sub lblMenu_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Index = 0 Then Chain_Link 1, "Start": lblOk.Visible = True
  If Index = 1 Then Hide_Preview "About"
  If Index = 2 Then End
End Sub
